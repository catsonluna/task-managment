import React, { useState, useRef, useEffect } from 'react';
import Head from 'next/head'
import Image from 'next/image'
import { Inter } from 'next/font/google'
import styles from '@/styles/create.module.css'
import Header from '../components/header'
import Cal from '../components/calendar'

const inter = Inter({ subsets: ['latin'] })

export default function Home() {
  const [text, setText] = useState('');
  const [rows, setRows] = useState(1);
  const maxRows = 10;
  const textAreaRef = useRef(null);

  const handleChange = (event) => {
    const textareaLineHeight = 24;
    const previousRows = event.target.rows;
    event.target.rows = 1;
    const currentRows = ~~(event.target.scrollHeight / textareaLineHeight);

    if (currentRows === previousRows) {
      event.target.rows = currentRows;
    }

    if (currentRows >= maxRows) {
      event.target.rows = maxRows;
      event.target.scrollTop = event.target.scrollHeight;
    }

    setText(event.target.value);
    setRows(currentRows < maxRows ? currentRows : maxRows);
  };

  useEffect(() => {
    window.scrollTo({
      top: textAreaRef.current.offsetTop,
      behavior: "smooth"
    });
  }, [rows]);

  return (
    <>
      <Head>
        <title>Make tasks</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={`${styles.main}`}>
        <Header />
        <div className={styles.description}>
            <form className={`${styles.form}`}>
                <div className={`${styles.fix}`}>{/*date*/}
                    <div className={`${styles.calc}`}>
                        <Cal />
                    </div>
                </div>
                <div className={`${styles.formatting}`}>{/*viss parejais*/}
                    <input type="text" className={`${styles.input}`} placeholder="Enter text here" />
                    <textarea ref={textAreaRef} rows={rows} cols="30" className={`${styles.input}`} placeholder="Enter text here" onChange={handleChange}></textarea>
                </div>
            </form>
        </div>
      </main>
    </>
  )
}
